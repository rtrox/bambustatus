services:
  bambustatus-streamer:
    image: ghcr.io/rtrox/bambustatus-streamer:latest
    # Uncomment to build locally instead:
    # build:
    #   context: .
    #   dockerfile: Dockerfile.streamer
    ports:
      - "8080:8080" # BambuStatus web interface
      - "8554:8554" # RTSP output stream (not used when OUTPUT_RTMP is set)
    environment:
      # Printer configuration (required)
      PRINTER_HOST: "192.168.1.100"
      PRINTER_PASSWORD: "your-printer-password"
      PRINTER_PORT: "8883"
      PRINTER_USERNAME: "bblp"
      PRINTER_SERIAL: "" # Auto-discovered if empty

      # RTSP input stream (required)
      INPUT_RTSP: "rtsps://bblp:password@192.168.1.100:322/streaming/live/1"

      # RTMP output stream (optional)
      OUTPUT_RTMP: "rtmp://your-rtmp-server.example.com/live/streamkey"

      # Overlay settings (optional)
      OVERLAY_URL: "http://localhost:8080"
      OVERLAY_FILE: "/tmp/overlay/current.png"
      OVERLAY_X: "10" # X position (pixels from left)
      OVERLAY_Y: "10" # Y position (pixels from top)
      CAPTURE_INTERVAL: "1" # Overlay refresh rate (seconds)
    restart: unless-stopped
